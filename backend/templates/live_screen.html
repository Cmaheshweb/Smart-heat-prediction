<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="refresh" content="10">
<title>Live Server Status</title>

<style>
    body {
        background: #020617;
        color: #e5e7eb;
        font-family: Arial, sans-serif;
        padding: 20px;
    }

    h1 {
        color: #38bdf8;
        margin-bottom: 20px;
    }

    .card {
        background: #111827;
        padding: 20px;
        border-radius: 14px;
        border: 4px solid #1e293b;
        max-width: 520px;
    }

    .label {
        color: #94a3b8;
        font-weight: bold;
    }

    .GREEN { color: #4ade80; }
    .YELLOW { color: #fde047; }
    .ORANGE { color: #fb923c; }
    .RED { color: #f87171; }

    /* ===== CRITICAL BLINK ===== */
    .CRITICAL {
        animation: blink 1s infinite;
    }

    @keyframes blink {
        0%   { border-color: #ef4444; box-shadow: 0 0 14px #ef4444; }
        50%  { border-color: transparent; box-shadow: none; }
        100% { border-color: #ef4444; box-shadow: 0 0 14px #ef4444; }
    }

    .alert-text {
        margin-top: 14px;
        font-size: 16px;
        font-weight: bold;
    }
</style>
</head>

<body>

<h1>ðŸ–¥ Live Server Status (Auto refresh 10s)</h1>

<div id="card" class="card">Loading...</div>

<script>
fetch('/api/live-status')
.then(res => res.json())
.then(d => {

    const card = document.getElementById('card');
    card.className = 'card';

    if (d.severity === 'CRITICAL') {
        card.classList.add('CRITICAL');
    }

    card.innerHTML = `
        <p><span class="label">Server:</span> ${d.server_id}</p>
        <p><span class="label">HIT:</span> ${d.hit}%</p>
        <p><span class="label">State:</span>
            <span class="${d.severity}">${d.state}</span>
        </p>
        <p><span class="label">Severity:</span> ${d.severity}</p>
        <p><span class="label">Freeze:</span> ${d.freeze}</p>
        <p><span class="label">Actions:</span> ${d.actions.join(', ')}</p>

        <div class="alert-text ${d.severity}">
            ${d.freeze
                ? 'ðŸš¨ SERVER FREEZED â€“ TRAFFIC REDIRECTED'
                : 'System Normal'}
        </div>
    `;
})
.catch(() => {
    document.getElementById('card').innerHTML =
        '<p style="color:red">Failed to load live status</p>';
});
</script>

</body>
</html>